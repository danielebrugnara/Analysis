(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     35003,        918]
NotebookOptionsPosition[     34226,        900]
NotebookOutlinePosition[     34560,        915]
CellTagsIndexPosition[     34517,        912]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ymc", "=", 
    RowBox[{"183", "*", 
     SuperscriptBox["10", "9"]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Elastic", " ", "modulus", " ", "in", " ", "compression"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ymt", "=", 
    RowBox[{"210", "*", 
     SuperscriptBox["10", "9"]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Elastic", " ", "modulus", " ", "in", " ", "tension"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sm", "=", 
    RowBox[{"82", "*", 
     SuperscriptBox["10", "9"]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Shear", " ", "modulus"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pr", "=", "0.28"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Poisson", " ", "ratio"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     FractionBox["ymt", 
      RowBox[{"2", "sm"}]], "-", "1"}], "]"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"CORRECT", "!"}], " ", "pr", " ", "computed", " ", "with", " ", 
     RowBox[{"formula", ":", " ", "https", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
      "Lam"}], "%", "C3", "%", "A9_parameters"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"yy", "*", "nu"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "nu"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "nu"}]}], ")"}]}]], "\[Equal]", "lambda"}], ",", 
       RowBox[{
        FractionBox["yy", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"1", "+", "nu"}], ")"}]}]], "\[Equal]", "mu"}]}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"yy", ",", " ", "nu"}], "}"}]}], "]"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"CORRECT", "!"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"l1", " ", "=", 
    FractionBox[
     RowBox[{"ymt", "*", "pr"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "pr"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "pr"}]}], ")"}]}]]}], ";"}], 
  RowBox[{"(*", "lambda", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"l2", "=", 
    FractionBox["ymt", 
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{"1", "+", "pr"}], ")"}]}]]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"mu", ",", " ", 
    RowBox[{"shear", " ", "modulus", " ", 
     RowBox[{
      RowBox[{"CORRECT", "!!"}], "!"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thickness", "=", "1.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radius", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"start", "=", " ", "0.00000001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pressure", "=", 
   RowBox[{"7.", "*", 
    SuperscriptBox["10", "4"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hthickness", "=", "0.0038"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Epsilon]", "=", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["pr", "2"]}], ")"}], "*", "radius", "*", "pressure"}], 
   RowBox[{"ymt", "*", "hthickness"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Nu]", "=", "pr"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]x", "=", "6.4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]y", "=", "4.4"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"approximate", " ", "beamspot", " ", "y", " ", "exp", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"x", "^", "2"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"\[Sigma]y", "^", "2"}]}], ")"}]}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"beamfunc", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], " ", "=", " ", 
   SuperscriptBox["E", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SuperscriptBox["x", "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Sigma]x", "2"]}]], "+", 
       FractionBox[
        SuperscriptBox["y", "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Sigma]y", "2"]}]]}], ")"}]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"beamfuncpolar", "[", 
     RowBox[{"\[Rho]_", ",", "\[Theta]_"}], "]"}], " ", "=", " ", 
    SuperscriptBox["E", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Sigma]x", "2"]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Sigma]y", "2"]}]]}], ")"}]}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdxTtIAgEABmARLCJqKEy5UugyJ4MoggjSbtChyRokyeiBgQ4+Mscgezi4
FS3SIJw1WBgUBTVYEoo97GUGDUZkhEheInJEikX3O3x87TO20Vk+j8cjOLgQ
maAJFUOtuXQ7+OYhfY4TNHGFvSpJAisqg4/4W9P3jA3K7AtuJONNrdwVbU8z
7n1d1eLjyaARj7hFZmzXbzvxtfUjjKN0IIpbBB33mDDs5/C4OPGDXWpRCS8k
C6E27nLgr3qtvMa/NMxQvv69IBanD4/w++7TGdZYMhGcOfAlMV/tTuO8aTOH
76akRWy0mFg8QId/cUg4xF/mDkhS9fg2XteA7dmUEHvf1qX49OKzE1/GFrux
rcgqsZRUqHBeKCjhXEFbXTc9Rq5wy07cckxWnAo8r5d0YcfXhr9sZqiYR7CF
PV52TmRlKKdY5sD/lxfMZw==
  "],
 CellLabel->"In[1]:=",ExpressionUUID->"da58d656-8c53-41be-9b26-60e059231fb5"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Solve", " ", "equations"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["\[Rho]", "1"], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[Rho]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"r2", "[", "\[Rho]", "]"}], ",", "\[Rho]"}], "]"}], 
               ")"}], "+", 
              FractionBox[
               RowBox[{"\[Nu]", " ", 
                RowBox[{"r2", "[", "\[Rho]", "]"}]}], "1"], "+", 
              RowBox[{
               FractionBox["1", "2"], "\[Rho]", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"z1", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], 
                  "]"}], ")"}], "2"]}]}], ")"}]}], ",", " ", "\[Rho]"}], 
          "]"}]}], "-", 
        RowBox[{
         FractionBox["\[Nu]", "1"], "\[Rho]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"r2", "[", "\[Rho]", "]"}], ",", "\[Rho]"}], "]"}], "+", 
           
           RowBox[{
            FractionBox["1", "2"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"z1", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], 
               "]"}], ")"}], "2"]}]}], ")"}]}], "-", 
        FractionBox[
         RowBox[{"r2", "[", "\[Rho]", "]"}], "1"]}], "\[Equal]", "0"}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "1"], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"(", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"z1", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], "]"}],
             ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"r2", "[", "\[Rho]", "]"}], ",", "\[Rho]"}], "]"}], 
              "\[Rho]"}], "+", 
             RowBox[{"\[Nu]", " ", 
              FractionBox[
               RowBox[{"r2", "[", "\[Rho]", "]"}], "1"]}], "+", 
             RowBox[{
              FractionBox["1", "2"], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"z1", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], 
                 "]"}], ")"}], "2"], "\[Rho]"}]}], ")"}]}], ",", " ", 
          "\[Rho]"}], "]"}]}], "\[Equal]", 
       RowBox[{"-", "\[Rho]"}]}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eq1", ",", " ", "eq2", ",", " ", 
         RowBox[{
          RowBox[{"r2", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"z1", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"z1", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], "]"}],
             "/.", 
            RowBox[{"\[Rho]", "\[Rule]", "0"}]}], ")"}], "\[Equal]", "0"}], 
         " ", ",", " ", 
         RowBox[{
          RowBox[{"r2", "[", "start", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"r2", ",", " ", "z1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", "start", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.777708002174287*^9, 3.777708014972583*^9}, {
   3.777708118207963*^9, 3.777708184980908*^9}, 3.7777082983885403`*^9, {
   3.777708539890696*^9, 3.777708543357027*^9}, {3.777708590383491*^9, 
   3.777708590527741*^9}, {3.7777088230681458`*^9, 3.777708823449256*^9}, {
   3.777708876596871*^9, 3.777708877274721*^9}, {3.77770932920009*^9, 
   3.77770933559844*^9}, {3.777709392527816*^9, 3.777709477526908*^9}, {
   3.777709521347165*^9, 3.777709530171109*^9}, {3.777709622036943*^9, 
   3.7777097060599813`*^9}, {3.777709739737862*^9, 3.777709741034206*^9}, {
   3.777709799824848*^9, 3.7777098000925217`*^9}, {3.777709842400062*^9, 
   3.777709858837344*^9}, {3.777709968969767*^9, 3.777709978957468*^9}, {
   3.777710009269081*^9, 3.7777100724813013`*^9}, {3.777710155156724*^9, 
   3.777710156067*^9}, {3.7777104429782467`*^9, 3.777710455833209*^9}, {
   3.777778691331846*^9, 3.777778734117399*^9}, {3.777780229676558*^9, 
   3.777780268557888*^9}, {3.777780334600534*^9, 3.777780477498157*^9}, {
   3.777781024228546*^9, 3.777781109815386*^9}, {3.777781151974931*^9, 
   3.777781241979903*^9}, {3.7777812750323877`*^9, 3.7777812872458277`*^9}, {
   3.777782129573913*^9, 3.777782162527505*^9}, {3.780637078453073*^9, 
   3.780637088024249*^9}, 3.780637404450637*^9, {3.7806380539351254`*^9, 
   3.780638055614006*^9}, {3.7806381450954657`*^9, 3.780638147654522*^9}, {
   3.78063827247983*^9, 3.7806382908314047`*^9}, {3.780638322636106*^9, 
   3.7806383252477007`*^9}, {3.780638359920288*^9, 3.78063836130343*^9}, {
   3.780638539089766*^9, 3.780638545976837*^9}, {3.780638612704976*^9, 
   3.7806386137207403`*^9}, {3.780638662506576*^9, 3.780638686988493*^9}, 
   3.7806388064577503`*^9, {3.780639605762248*^9, 3.780639648278507*^9}, {
   3.7806408892647047`*^9, 3.780640897512039*^9}, 3.78064092924515*^9, {
   3.78064133229498*^9, 3.780641360181625*^9}, {3.7899704851143303`*^9, 
   3.789970520615686*^9}, {3.791178515406781*^9, 3.791178515498603*^9}, {
   3.791183349133174*^9, 3.791183356872357*^9}, {3.797160445777047*^9, 
   3.79716044696953*^9}, 3.79716051172834*^9, {3.79716179962648*^9, 
   3.797161804462084*^9}, {3.797161910499857*^9, 3.797161912420643*^9}, {
   3.797162515894614*^9, 3.797162611020392*^9}, {3.79716268771198*^9, 
   3.797162694569661*^9}, 3.7971627254434433`*^9, {3.797164156337281*^9, 
   3.797164168605646*^9}, {3.813663642144178*^9, 3.8136636438713293`*^9}, {
   3.815816464020672*^9, 3.815816479385594*^9}, 3.8158165570168056`*^9, {
   3.815817810318881*^9, 3.8158178107422123`*^9}, {3.815818306536664*^9, 
   3.8158183287351027`*^9}, {3.815818374307435*^9, 3.8158184113401814`*^9}, 
   3.820144955079219*^9},ExpressionUUID->"d87e94d5-04b1-41f3-8592-\
30c7170554c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Plot", " ", "deformation"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"expr0", " ", "[", "\[Rho]_", "]"}], "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"radius", "*", 
        RowBox[{"(", 
         RowBox[{"\[Rho]", "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", 
            RowBox[{"2", "/", "3"}]], " ", 
           RowBox[{"r2", "[", "\[Rho]", "]"}]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"radius", "*", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", 
            RowBox[{"1", "/", "3", " "}]], 
           RowBox[{"z1", "[", "\[Rho]", "]"}]}], ")"}]}], "+", 
        "thickness"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plt1", "=", " ", 
     RowBox[{"ParametricPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Evaluate", "[", 
         RowBox[{
          RowBox[{"expr0", "[", "\[Rho]", "]"}], "/.", "s"}], "]"}], "}"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", " ", "start", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "8.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "3"}], "}"}]}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{"plt1", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Radius [mm]\>\"", ",", "\"\<Distance from center [mm]\>\""}], 
       "}"}]}], ",", " ", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"Target", " ", "deformation", " ", "profile"}], "]"}]}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"GrayLevel", "[", "0", "]"}], "}"}]}], ",", " ", 
     RowBox[{"PlotTheme", "->", "\"\<Minimal\>\""}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ParametricPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"radius", "*", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               SuperscriptBox["\[Epsilon]", 
                RowBox[{"2", "/", "3"}]], 
               RowBox[{
                RowBox[{"r2", "'"}], "[", "\[Rho]", "]"}]}]}], ")"}]}], ",", 
           RowBox[{"radius", "*", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Epsilon]", 
               RowBox[{"1", "/", "3"}]], 
              RowBox[{
               RowBox[{"z1", "'"}], "[", "\[Rho]", "]"}]}], ")"}]}]}], "}"}], 
         "/.", "s"}], "]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"\[Rho]", ",", " ", "start", ",", " ", "1"}], "}"}], ",", " ", 
      
      RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ParametricPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"r2", "[", "\[Rho]", "]"}], ",", " ", 
         RowBox[{"z1", "[", "\[Rho]", "]"}]}], "]"}], "/.", "s"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"\[Rho]", ",", " ", "0.1", ",", " ", "1"}], "}"}]}], "]"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8158183859972963`*^9, 3.8158184009799433`*^9}, {
  3.815818511229035*^9, 3.8158185171880713`*^9}, {3.815818855240604*^9, 
  3.815818857728409*^9}, {3.815819567232419*^9, 3.815819571666737*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"06a99d97-c166-422f-a469-fb5c4f291e66"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Compute", " ", "average", " ", "beam", " ", "thickness", " ", "to", " ", 
    "pass", " ", "target"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ListPointPlot3D", "[", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"beamfunc", "[", 
       RowBox[{
       "x", ",", " ", "y", ",", " ", "\[Sigma]x", ",", " ", "\[Sigma]y"}], 
       "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", " ", 
        RowBox[{"-", "10"}], ",", " ", "10", ",", " ", "0.1"}], "}"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", " ", 
        RowBox[{"-", "10"}], ",", " ", "10", ",", " ", "0.1"}], "}"}]}], 
     "]"}], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"beamfuncpolar", "[", 
      RowBox[{"\[Rho]", ",", " ", "\[Theta]"}], "]"}], "*", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"expr0", "[", "\[Rho]", "]"}], "/.", 
       RowBox[{"s", "*", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fun", "=", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"expr0", " ", "[", "\[Rho]", "]"}], "/.", 
         RowBox[{"s", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
         "\[Rho]", ",", " ", "start", ",", " ", "1", ",", " ", "0.05"}], 
         "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"liminf", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limsup", "=", "7.9"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"beamfuncpolar", "[", 
           RowBox[{"\[Rho]", ",", " ", "\[Theta]"}], "]"}], "*", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"\[Rho]", ",", " ", "liminf", ",", " ", "limsup"}], "}"}], 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", " ", "0", ",", " ", "\[Pi]"}], "}"}]}], 
        "]"}]], "*", 
      RowBox[{"beamfuncpolar", "[", 
       RowBox[{"\[Rho]", ",", " ", "\[Theta]"}], "]"}], "*", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"2", "*", 
        RowBox[{"fun", "[", "\[Rho]", "]"}]}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[Rho]", ",", " ", "liminf", ",", " ", "limsup"}], "}"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", " ", "0", ",", " ", "\[Pi]"}], "}"}]}], "]"}], 
   
   RowBox[{"(*", 
    RowBox[{"mean", " ", "thickness"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<He_thickness_700mbar_euc.txt\>\"", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\[Rho]", ",", " ", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"fun", "[", "\[Rho]", "]"}], "]"}]}], "}"}], "}"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{
        "\[Rho]", ",", " ", "start", ",", " ", "8.0", ",", " ", "0.01"}], 
        "}"}]}], "]"}]}], "]"}], 
   RowBox[{"(*", 
    RowBox[{"deformation", " ", "in", " ", "cartesian", " ", "coordinates"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.79716051651198*^9, 3.797160528643029*^9}, {
   3.79716057597491*^9, 3.7971605957230263`*^9}, {3.797160630642906*^9, 
   3.797160633445891*^9}, {3.7971608192311897`*^9, 3.797160828238605*^9}, {
   3.797160982186842*^9, 3.797160984177868*^9}, 3.79716178456779*^9, {
   3.797161879684834*^9, 3.797161891241276*^9}, {3.797162010777425*^9, 
   3.7971620193847637`*^9}, {3.7971622311299067`*^9, 3.797162236840966*^9}, {
   3.797162307555223*^9, 3.797162404780547*^9}, {3.797162729297749*^9, 
   3.797163016292804*^9}, {3.79716309875406*^9, 3.797163137395021*^9}, {
   3.797163168413275*^9, 3.7971631694919167`*^9}, {3.79716327845931*^9, 
   3.797163278638727*^9}, {3.797163333992714*^9, 3.7971633407391376`*^9}, {
   3.797163414154591*^9, 3.797163416809832*^9}, {3.7971634897504263`*^9, 
   3.797163635066753*^9}, {3.7971636654208107`*^9, 3.797163695462946*^9}, {
   3.797163737322209*^9, 3.797163760142964*^9}, {3.7971638051809797`*^9, 
   3.7971639338629847`*^9}, {3.79716408295711*^9, 3.7971640860673523`*^9}, {
   3.8001702736728086`*^9, 3.800170353584197*^9}, {3.8001704036498737`*^9, 
   3.8001704258592052`*^9}, {3.813660307385248*^9, 3.8136603090785503`*^9}, {
   3.813660741043769*^9, 3.8136607643999968`*^9}, {3.813660801104072*^9, 
   3.8136608011951923`*^9}, {3.813662334633047*^9, 3.813662344574177*^9}, {
   3.815818276406802*^9, 3.8158182773226624`*^9}, 3.815818498306426*^9, {
   3.8158185309038057`*^9, 3.81581855369235*^9}, 3.8201444620891533`*^9, {
   3.8201445530424128`*^9, 3.820144556285245*^9}, {3.820144597384178*^9, 
   3.82014459751921*^9}, {3.8201448821277323`*^9, 3.820144885213228*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"e57459e0-3751-46c7-9972-529c77c04cbf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "thickness", " ", "as", " ", "a", " ", "function", " ", "of", " ", "angle",
     " ", "from", " ", "normal"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"expr1", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ArcTan", "[", 
        RowBox[{"radius", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Rho]", "+", 
            RowBox[{
             SuperscriptBox["\[Epsilon]", 
              RowBox[{"2", "/", "3"}]], " ", 
             RowBox[{"r2", "[", "\[Rho]", "]"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"radius", "*", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Epsilon]", 
                RowBox[{"1", "/", "3", " "}]], 
               RowBox[{"z1", "[", "\[Rho]", "]"}]}], ")"}]}], "+", 
            "thickness"}], ")"}]}]}], "]"}], ",", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"radius", "*", 
            RowBox[{"(", 
             RowBox[{"\[Rho]", "+", 
              RowBox[{
               SuperscriptBox["\[Epsilon]", 
                RowBox[{"2", "/", "3"}]], " ", 
               RowBox[{"r2", "[", "\[Rho]", "]"}]}]}], ")"}]}], ")"}], "2"], 
         "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"radius", "*", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Epsilon]", 
                RowBox[{"1", "/", "3", " "}]], 
               RowBox[{"z1", "[", "\[Rho]", "]"}]}], ")"}]}], "+", 
            "thickness"}], ")"}], "2"]}]]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p1", " ", "=", " ", 
     RowBox[{"ParametricPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"expr1", "/.", "s"}], "]"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", " ", "start", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "10"}], " ", "}"}]}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p2", " ", "=", " ", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"thickness", "/", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", " ", "0", ",", " ", "1.5"}], "}"}], ",", " ", 
       RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plt2", " ", "=", " ", 
     RowBox[{"Show", "[", 
      RowBox[{"p1", ",", " ", "p2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{"plt2", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Angle [rad]\>\"", ",", "\"\<Thickness [mm]\>\""}], 
       "}"}]}], ",", " ", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"Effective", " ", "thickness"}], "]"}]}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"GrayLevel", "[", "0", "]"}], "}"}]}], ",", " ", 
     RowBox[{"PlotTheme", "->", "\"\<Minimal\>\""}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<He_thickness_700mbar.txt\>\"", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"expr1", "/.", "s"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "\[Rho]", ",", " ", "start", ",", " ", "2.0", ",", " ", "0.001"}], 
        "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQfebV9Yr/Wm8c2XbkNoPoORcYO0H0pYDZ00G027a8
lyA67ET8axDNkLDBmUH7jWPk66+uILpmzkEvEK25QcUXRD/atSAERO+bMT0M
RG9o4YwF0S88HiSD6MsZ73NANN/X0mIQfeb1kfLTNm8cPwWvqwTRB+52TgHR
HxZyzwLRArLnF4DoCrO7q0B0qefObSD6TrnNThDtPE+57wyQ7lDUAtNz9rrP
BdFhs33ng2gDT19lWfs3jhw/S8D0h8OHakG0hLh4PYj+PUntuEQeUD1/P5iO
+9h+DkRPmLL2AoielCtwFURnqG27BaLfvK95CqJF9J+B6Vmc5+UlQfJfhJVB
NABKSqbo
  "],
 CellLabel->
  "In[196]:=",ExpressionUUID->"93de9c2c-8193-4261-b004-6b670902a463"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "havar", " ", "entrance", " ", "angle", " ", "as", " ", "a", " ", 
    "function", " ", "of", " ", "angle", " ", "from", " ", "normal"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"expr2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ArcTan", "[", 
        RowBox[{"radius", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Rho]", "+", 
            RowBox[{
             SuperscriptBox["\[Epsilon]", 
              RowBox[{"2", "/", "3"}]], " ", 
             RowBox[{"r2", "[", "\[Rho]", "]"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"radius", "*", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Epsilon]", 
                RowBox[{"1", "/", "3", " "}]], 
               RowBox[{"z1", "[", "\[Rho]", "]"}]}], ")"}]}], "+", 
            "thickness"}], ")"}]}]}], "]"}], ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "-", 
        RowBox[{"ArcCos", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"radius", "*", 
              RowBox[{"(", 
               RowBox[{"\[Rho]", "+", 
                RowBox[{
                 SuperscriptBox["\[Epsilon]", 
                  RowBox[{"2", "/", "3"}]], " ", 
                 RowBox[{"r2", "[", "\[Rho]", "]"}]}]}], ")"}], "*", "radius",
               "*", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{
                 SuperscriptBox["\[Epsilon]", 
                  RowBox[{"2", "/", "3"}]], " ", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"r2", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], 
                  "]"}]}]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"radius", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Epsilon]", 
                    RowBox[{"1", "/", "3", " "}]], 
                   RowBox[{"z1", "[", "\[Rho]", "]"}]}], ")"}]}], "+", 
                "thickness"}], ")"}], "*", "radius", "*", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Epsilon]", 
                 RowBox[{"1", "/", "3", " "}]], 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"z1", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], 
                 "]"}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"radius", "*", 
                  RowBox[{"(", 
                   RowBox[{"\[Rho]", "+", 
                    RowBox[{
                    SuperscriptBox["\[Epsilon]", 
                    RowBox[{"2", "/", "3"}]], " ", 
                    RowBox[{"r2", "[", "\[Rho]", "]"}]}]}], ")"}]}], ")"}], 
                "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"radius", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Epsilon]", 
                    RowBox[{"1", "/", "3", " "}]], 
                    RowBox[{"z1", "[", "\[Rho]", "]"}]}], ")"}]}], "+", 
                  "thickness"}], ")"}], "2"]}]], "*", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"radius", "*", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{
                    SuperscriptBox["\[Epsilon]", 
                    RowBox[{"2", "/", "3"}]], " ", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"r2", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], 
                    "]"}]}]}], ")"}]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"radius", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["\[Epsilon]", 
                    RowBox[{"1", "/", "3", " "}]], 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"z1", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], 
                    "]"}]}], ")"}]}], ")"}], "2"]}]]}], ")"}]}], ")"}], 
         "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p3", " ", "=", " ", 
     RowBox[{"ParametricPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"expr2", "/.", "s"}], "]"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", " ", "start", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "1.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1.2"}], "}"}]}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p4", " ", "=", " ", 
     RowBox[{"Plot", "[", 
      RowBox[{"\[Theta]", ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", " ", "0", ",", " ", "1.5"}], "}"}], ",", " ", 
       RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plt3", " ", "=", " ", 
     RowBox[{"Show", "[", 
      RowBox[{"p3", ",", " ", "p4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{"plt3", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Angle [rad]\>\"", ",", "\"\<Entrance angle [rad]\>\""}], 
       "}"}]}], ",", " ", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"Entrance", " ", "angle", " ", "in", " ", "HAVAR"}], "]"}]}], 
     ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"GrayLevel", "[", "0", "]"}], "}"}]}], ",", " ", 
     RowBox[{"PlotTheme", "->", "\"\<Minimal\>\""}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<Entrance_angle_700mbar.txt\>\"", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"expr2", "/.", "s"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "\[Rho]", ",", " ", "start", ",", " ", "1.5", ",", " ", "0.001"}], 
        "}"}]}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.780639939323229*^9, 3.7806399509080343`*^9}, {
  3.7806399853157187`*^9, 3.780640207864439*^9}, {3.7806405694194183`*^9, 
  3.780640570523367*^9}, {3.78064060734444*^9, 3.780640607905321*^9}, {
  3.780640713014061*^9, 3.780640810699692*^9}, {3.780640848126244*^9, 
  3.780640858420368*^9}, {3.780641049398553*^9, 3.780641145234251*^9}, {
  3.780641398928406*^9, 3.780641438039905*^9}, {3.780641586680966*^9, 
  3.780641601366126*^9}, {3.7899709280840807`*^9, 3.789970975774055*^9}, {
  3.789972556656567*^9, 3.789972581755719*^9}, {3.791186978464328*^9, 
  3.79118701205443*^9}, {3.8158188246087646`*^9, 3.8158188270000353`*^9}, {
  3.815818979885955*^9, 3.815819013695888*^9}, {3.815819063689975*^9, 
  3.815819076587316*^9}, {3.8158193128222523`*^9, 3.815819320303925*^9}, {
  3.81581955349475*^9, 3.815819558740304*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"3ab304f3-85c6-4cda-885f-d771ea7ce6ef"]
},
WindowSize->{1920, 1016},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5862, 183, 676, "Input",ExpressionUUID->"da58d656-8c53-41be-9b26-60e059231fb5"],
Cell[6423, 205, 6671, 152, 181, "Input",ExpressionUUID->"d87e94d5-04b1-41f3-8592-30c7170554c5"],
Cell[13097, 359, 3788, 103, 157, "Input",ExpressionUUID->"06a99d97-c166-422f-a469-fb5c4f291e66"],
Cell[16888, 464, 5317, 122, 306, "Input",ExpressionUUID->"e57459e0-3751-46c7-9972-529c77c04cbf"],
Cell[22208, 588, 4388, 118, 223, "Input",ExpressionUUID->"93de9c2c-8193-4261-b004-6b670902a463"],
Cell[26599, 708, 7623, 190, 328, "Input",ExpressionUUID->"3ab304f3-85c6-4cda-885f-d771ea7ce6ef"]
}
]
*)

