(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42874,       1131]
NotebookOptionsPosition[     41810,       1110]
NotebookOutlinePosition[     42144,       1125]
CellTagsIndexPosition[     42101,       1122]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ymc", "=", 
    RowBox[{"183", "*", 
     SuperscriptBox["10", "9"]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Elastic", " ", "modulus", " ", "in", " ", "compression"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ymt", "=", 
    RowBox[{"210", "*", 
     SuperscriptBox["10", "9"]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Elastic", " ", "modulus", " ", "in", " ", "tension"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sm", "=", 
    RowBox[{"82", "*", 
     SuperscriptBox["10", "9"]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Shear", " ", "modulus"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pr", "=", "0.28"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Poisson", " ", "ratio"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     FractionBox["ymt", 
      RowBox[{"2", "sm"}]], "-", "1"}], "]"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"CORRECT", "!"}], " ", "pr", " ", "computed", " ", "with", " ", 
     RowBox[{"formula", ":", " ", "https", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
      "Lam"}], "%", "C3", "%", "A9_parameters"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"yy", "*", "nu"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "nu"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "nu"}]}], ")"}]}]], "\[Equal]", "lambda"}], ",", 
       RowBox[{
        FractionBox["yy", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"1", "+", "nu"}], ")"}]}]], "\[Equal]", "mu"}]}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"yy", ",", " ", "nu"}], "}"}]}], "]"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"CORRECT", "!"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l1", " ", "=", 
   FractionBox[
    RowBox[{"ymt", "*", "pr"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "pr"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "pr"}]}], ")"}]}]]}], ";", 
  RowBox[{"(*", "lambda", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"l2", "=", 
   FractionBox["ymt", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"1", "+", "pr"}], ")"}]}]]}], ";", 
  RowBox[{"(*", 
   RowBox[{"mu", ",", " ", 
    RowBox[{"shear", " ", "modulus", " ", 
     RowBox[{
      RowBox[{"CORRECT", "!!"}], "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"thickness", "=", "1.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radius", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"start", "=", " ", "0.00000001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pressure", "=", 
   RowBox[{"6.67", "*", 
    SuperscriptBox["10", "4"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hthickness", "=", "0.0038"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Epsilon]", "=", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["pr", "2"]}], ")"}], "*", "radius", "*", "pressure"}], 
   RowBox[{"ymt", "*", "hthickness"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Nu]", "=", "pr"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]x", "=", "6.4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]y", "=", "4.4"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"approximate", " ", "beamspot", " ", "y", " ", "exp", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"x", "^", "2"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"\[Sigma]y", "^", "2"}]}], ")"}]}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"beamfunc", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], " ", "=", " ", 
   SuperscriptBox["E", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SuperscriptBox["x", "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Sigma]x", "2"]}]], "+", 
       FractionBox[
        SuperscriptBox["y", "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Sigma]y", "2"]}]]}], ")"}]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"beamfuncpolar", "[", 
     RowBox[{"\[Rho]_", ",", "\[Theta]_"}], "]"}], " ", "=", " ", 
    SuperscriptBox["E", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Sigma]x", "2"]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Sigma]y", "2"]}]]}], ")"}]}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdxTtIAgEABuBDsIioobg8rk7oKieDKIII8nLQockaJMnogYENppBjkD3c
a5MG4aLhCoOioAZLQullr8ugwYguQqQTEZHIuKL7HT6+1mnvyIyGIAhKhQvx
cZ7mcua1gH0b3zxIZ1jk6Ssc4hgRG5WBR/xl7X3GTlP2BdezyYZmdcXW3Yh7
Xldt+Ggi4sLDQd0s9jm2/Ph67iOGE7yQwE3atntMO/dkPEaJ3zhg0ZXxQqoQ
bVH/Ef4qVxuqNpeGcuZw324EU9LBIX7feTrFVk8mjjP74RTWWIISzrs3ZHw3
qS9il8ddwv187BdHyUHNsrrApGvxbbKmDvuyaRKH3tb1+OTiswNfni92YW+x
ZMJ61sjhPKktY7lgq2yfGmVX1NuPgwbMKn4jnncwnfgf63C7rg==
  "],
 CellLabel->"In[1]:=",ExpressionUUID->"da58d656-8c53-41be-9b26-60e059231fb5"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["\[Rho]", "1"], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[Rho]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"r2", "[", "\[Rho]", "]"}], ",", "\[Rho]"}], "]"}], 
               ")"}], "+", 
              FractionBox[
               RowBox[{"\[Nu]", " ", 
                RowBox[{"r2", "[", "\[Rho]", "]"}]}], "1"], "+", 
              RowBox[{
               FractionBox["1", "2"], "\[Rho]", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"z1", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], 
                  "]"}], ")"}], "2"]}]}], ")"}]}], ",", " ", "\[Rho]"}], 
          "]"}]}], "-", 
        RowBox[{
         FractionBox["\[Nu]", "1"], "\[Rho]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"r2", "[", "\[Rho]", "]"}], ",", "\[Rho]"}], "]"}], "+", 
           
           RowBox[{
            FractionBox["1", "2"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"z1", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], 
               "]"}], ")"}], "2"]}]}], ")"}]}], "-", 
        FractionBox[
         RowBox[{"r2", "[", "\[Rho]", "]"}], "1"]}], "\[Equal]", "0"}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "1"], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"(", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"z1", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], "]"}],
             ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"r2", "[", "\[Rho]", "]"}], ",", "\[Rho]"}], "]"}], 
              "\[Rho]"}], "+", 
             RowBox[{"\[Nu]", " ", 
              FractionBox[
               RowBox[{"r2", "[", "\[Rho]", "]"}], "1"]}], "+", 
             RowBox[{
              FractionBox["1", "2"], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"z1", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], 
                 "]"}], ")"}], "2"], "\[Rho]"}]}], ")"}]}], ",", " ", 
          "\[Rho]"}], "]"}]}], "\[Equal]", 
       RowBox[{"-", "\[Rho]"}]}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eq1", ",", " ", "eq2", ",", " ", 
         RowBox[{
          RowBox[{"r2", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"z1", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"z1", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], "]"}],
             "/.", 
            RowBox[{"\[Rho]", "\[Rule]", "0"}]}], ")"}], "\[Equal]", "0"}], 
         " ", ",", " ", 
         RowBox[{
          RowBox[{"r2", "[", "start", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"r2", ",", " ", "z1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", "start", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"simplethickness", " ", "plot"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"expr0", " ", "[", "\[Rho]_", "]"}], "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"radius", "*", 
        RowBox[{"(", 
         RowBox[{"\[Rho]", "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", 
            RowBox[{"2", "/", "3"}]], " ", 
           RowBox[{"r2", "[", "\[Rho]", "]"}]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"radius", "*", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", 
            RowBox[{"1", "/", "3", " "}]], 
           RowBox[{"z1", "[", "\[Rho]", "]"}]}], ")"}]}], "+", 
        "thickness"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{"expr0", "[", "\[Rho]", "]"}], "/.", "s"}], "]"}], "}"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"\[Rho]", ",", " ", "start", ",", " ", "1"}], "}"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "8.5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "3"}], "}"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ParametricPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"radius", "*", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               SuperscriptBox["\[Epsilon]", 
                RowBox[{"2", "/", "3"}]], 
               RowBox[{
                RowBox[{"r2", "'"}], "[", "\[Rho]", "]"}]}]}], ")"}]}], ",", 
           RowBox[{"radius", "*", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Epsilon]", 
               RowBox[{"1", "/", "3"}]], 
              RowBox[{
               RowBox[{"z1", "'"}], "[", "\[Rho]", "]"}]}], ")"}]}]}], "}"}], 
         "/.", "s"}], "]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"\[Rho]", ",", " ", "start", ",", " ", "1"}], "}"}], ",", " ", 
      
      RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ParametricPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"r2", "[", "\[Rho]", "]"}], ",", " ", 
         RowBox[{"z1", "[", "\[Rho]", "]"}]}], "]"}], "/.", "s"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"\[Rho]", ",", " ", "0.1", ",", " ", "1"}], "}"}]}], "]"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.777708002174287*^9, 3.777708014972583*^9}, {
   3.777708118207963*^9, 3.777708184980908*^9}, 3.7777082983885403`*^9, {
   3.777708539890696*^9, 3.777708543357027*^9}, {3.777708590383491*^9, 
   3.777708590527741*^9}, {3.7777088230681458`*^9, 3.777708823449256*^9}, {
   3.777708876596871*^9, 3.777708877274721*^9}, {3.77770932920009*^9, 
   3.77770933559844*^9}, {3.777709392527816*^9, 3.777709477526908*^9}, {
   3.777709521347165*^9, 3.777709530171109*^9}, {3.777709622036943*^9, 
   3.7777097060599813`*^9}, {3.777709739737862*^9, 3.777709741034206*^9}, {
   3.777709799824848*^9, 3.7777098000925217`*^9}, {3.777709842400062*^9, 
   3.777709858837344*^9}, {3.777709968969767*^9, 3.777709978957468*^9}, {
   3.777710009269081*^9, 3.7777100724813013`*^9}, {3.777710155156724*^9, 
   3.777710156067*^9}, {3.7777104429782467`*^9, 3.777710455833209*^9}, {
   3.777778691331846*^9, 3.777778734117399*^9}, {3.777780229676558*^9, 
   3.777780268557888*^9}, {3.777780334600534*^9, 3.777780477498157*^9}, {
   3.777781024228546*^9, 3.777781109815386*^9}, {3.777781151974931*^9, 
   3.777781241979903*^9}, {3.7777812750323877`*^9, 3.7777812872458277`*^9}, {
   3.777782129573913*^9, 3.777782162527505*^9}, {3.780637078453073*^9, 
   3.780637088024249*^9}, 3.780637404450637*^9, {3.7806380539351254`*^9, 
   3.780638055614006*^9}, {3.7806381450954657`*^9, 3.780638147654522*^9}, {
   3.78063827247983*^9, 3.7806382908314047`*^9}, {3.780638322636106*^9, 
   3.7806383252477007`*^9}, {3.780638359920288*^9, 3.78063836130343*^9}, {
   3.780638539089766*^9, 3.780638545976837*^9}, {3.780638612704976*^9, 
   3.7806386137207403`*^9}, {3.780638662506576*^9, 3.780638686988493*^9}, 
   3.7806388064577503`*^9, {3.780639605762248*^9, 3.780639648278507*^9}, {
   3.7806408892647047`*^9, 3.780640897512039*^9}, 3.78064092924515*^9, {
   3.78064133229498*^9, 3.780641360181625*^9}, {3.7899704851143303`*^9, 
   3.789970520615686*^9}, {3.791178515406781*^9, 3.791178515498603*^9}, {
   3.791183349133174*^9, 3.791183356872357*^9}, {3.797160445777047*^9, 
   3.79716044696953*^9}, 3.79716051172834*^9, {3.79716179962648*^9, 
   3.797161804462084*^9}, {3.797161910499857*^9, 3.797161912420643*^9}, {
   3.797162515894614*^9, 3.797162611020392*^9}, {3.79716268771198*^9, 
   3.797162694569661*^9}, 3.7971627254434433`*^9, {3.797164156337281*^9, 
   3.797164168605646*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"d87e94d5-04b1-41f3-8592-30c7170554c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"ListPointPlot3D", "[", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"beamfunc", "[", 
       RowBox[{
       "x", ",", " ", "y", ",", " ", "\[Sigma]x", ",", " ", "\[Sigma]y"}], 
       "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", " ", 
        RowBox[{"-", "10"}], ",", " ", "10", ",", " ", "0.1"}], "}"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", " ", 
        RowBox[{"-", "10"}], ",", " ", "10", ",", " ", "0.1"}], "}"}]}], 
     "]"}], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"beamfuncpolar", "[", 
      RowBox[{"\[Rho]", ",", " ", "\[Theta]"}], "]"}], "*", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"expr0", "[", "\[Rho]", "]"}], "/.", 
       RowBox[{"s", "*", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"fun", "=", 
    RowBox[{"Interpolation", "[", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"expr0", " ", "[", "\[Rho]", "]"}], "/.", 
        RowBox[{"s", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "\[Rho]", ",", " ", "start", ",", " ", "1", ",", " ", "0.05"}], 
        "}"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"liminf", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limsup", "=", "7.5"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"beamfuncpolar", "[", 
           RowBox[{"\[Rho]", ",", " ", "\[Theta]"}], "]"}], "*", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"\[Rho]", ",", " ", "liminf", ",", " ", "limsup"}], "}"}], 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", " ", "0", ",", " ", "\[Pi]"}], "}"}]}], 
        "]"}]], "*", 
      RowBox[{"beamfuncpolar", "[", 
       RowBox[{"\[Rho]", ",", " ", "\[Theta]"}], "]"}], "*", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"2", "*", 
        RowBox[{"fun", "[", "\[Rho]", "]"}]}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[Rho]", ",", " ", "liminf", ",", " ", "limsup"}], "}"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", " ", "0", ",", " ", "\[Pi]"}], "}"}]}], "]"}], 
   
   RowBox[{"(*", 
    RowBox[{"mean", " ", "thickness"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.79716051651198*^9, 3.797160528643029*^9}, {
   3.79716057597491*^9, 3.7971605957230263`*^9}, {3.797160630642906*^9, 
   3.797160633445891*^9}, {3.7971608192311897`*^9, 3.797160828238605*^9}, {
   3.797160982186842*^9, 3.797160984177868*^9}, 3.79716178456779*^9, {
   3.797161879684834*^9, 3.797161891241276*^9}, {3.797162010777425*^9, 
   3.7971620193847637`*^9}, {3.7971622311299067`*^9, 3.797162236840966*^9}, {
   3.797162307555223*^9, 3.797162404780547*^9}, {3.797162729297749*^9, 
   3.797163016292804*^9}, {3.79716309875406*^9, 3.797163137395021*^9}, {
   3.797163168413275*^9, 3.7971631694919167`*^9}, {3.79716327845931*^9, 
   3.797163278638727*^9}, {3.797163333992714*^9, 3.7971633407391376`*^9}, {
   3.797163414154591*^9, 3.797163416809832*^9}, {3.7971634897504263`*^9, 
   3.797163635066753*^9}, {3.7971636654208107`*^9, 3.797163695462946*^9}, {
   3.797163737322209*^9, 3.797163760142964*^9}, {3.7971638051809797`*^9, 
   3.7971639338629847`*^9}, {3.79716408295711*^9, 3.7971640860673523`*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"e57459e0-3751-46c7-9972-529c77c04cbf"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Average", " ", "height", " ", "for", " ", "beam", " ", "spot"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"beamspot", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"upperlimit", " ", "=", " ", 
    RowBox[{"FindRoot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Evaluate", "[", 
                RowBox[{"expr0", "/.", "s"}], "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                "\[Rho]", ",", " ", "start", ",", " ", "1", ",", " ", 
                 "0.001"}], "}"}]}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", "x", "]"}], "-", 
       "beamspot"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "100"}], "}"}]}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{
    "find", " ", "end", " ", "of", " ", "interpolation", " ", "with", " ", 
     "a", " ", "given", " ", "beamspot"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"expr0", "/.", "s"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "\[Rho]", ",", " ", "start", ",", " ", "1", ",", " ", "0.001"}], 
            "}"}]}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", "500", "]"}], 
   RowBox[{"(*", 
    RowBox[{"final", " ", "x"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"expr0", "/.", "s"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "\[Rho]", ",", " ", "start", ",", " ", "1", ",", " ", "0.001"}], 
            "}"}]}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", "500", "]"}], 
   RowBox[{"(*", 
    RowBox[{"final", " ", "y"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"expr0", "/.", "s"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "\[Rho]", ",", " ", "start", ",", " ", "1", ",", " ", "0.001"}], 
            "}"}]}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", "1", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"expr0", "/.", "s"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "\[Rho]", ",", " ", "start", ",", " ", "1", ",", " ", "0.001"}], 
            "}"}]}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", "1", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{"expr0", "/.", "s"}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
             "\[Rho]", ",", " ", "start", ",", " ", "1", ",", " ", "0.001"}], 
             "}"}]}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", "1", "]"}], "*", "2", " ", 
    
    RowBox[{"(*", 
     RowBox[{"max", " ", "thickness"}], "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.790065002398779*^9, 3.7900650562758493`*^9}, {
   3.790065683679233*^9, 3.790065746808042*^9}, {3.790065787307317*^9, 
   3.790065802416469*^9}, {3.790065837192157*^9, 3.7900658598434763`*^9}, 
   3.790066741651348*^9, {3.791184997342984*^9, 3.791185000909773*^9}, {
   3.791185288765725*^9, 3.791185307807795*^9}, {3.791185354719007*^9, 
   3.791185373165991*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"922f1209-9b50-41be-bafb-7f36dc9f9131"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"root", " ", "=", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"beamspot", "/", 
           RowBox[{"(", "sig", ")"}]}], ")"}], "2"]}], "]"}], "-", "0.5"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"sig", ",", " ", "4"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gauss", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Rho]", "*", "radius"}], ",", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Rho]", "*", "radius"}], ")"}], "/", 
             RowBox[{"(", "4.804489635145799`", ")"}]}], ")"}], "2"]}], 
         "]"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
       "\[Rho]", ",", " ", "start", ",", " ", "1", ",", " ", "0.001"}], 
       "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x", "/", 
          RowBox[{"(", "4.804489635145799`", ")"}]}], ")"}], "2"]}], "]"}], 
     "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", " ", 
      RowBox[{"-", "5"}], ",", " ", "5"}], "}"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"place", " ", "root", " ", "here"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "gauss", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Rho]", "=", 
     RowBox[{"x", "*", 
      RowBox[{"498.9923674182382", "/", "4"}]}]}], ",", " ", 
    RowBox[{"d\[Rho]", " ", "=", 
     RowBox[{
      RowBox[{"498.9923674182382", "/", "4"}], " ", "dx"}]}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.790066036615479*^9, 3.790066110553083*^9}, {
   3.7900661457692213`*^9, 3.790066402688634*^9}, {3.790066449906746*^9, 
   3.7900665274855633`*^9}, {3.790066596182197*^9, 3.7900666254400043`*^9}, {
   3.7900667251148663`*^9, 3.790066753252491*^9}, 3.7900668097634478`*^9, 
   3.7900668477859173`*^9, {3.790066890604704*^9, 3.790067005493081*^9}, {
   3.790067276952498*^9, 3.790067341651476*^9}, {3.790067374567925*^9, 
   3.7900673827365427`*^9}, {3.790067425721549*^9, 3.790067532555272*^9}, {
   3.7900676921812487`*^9, 3.790067712476129*^9}, {3.790067742658778*^9, 
   3.79006774524236*^9}, {3.790067810715077*^9, 3.790067964893115*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"edfbac34-8e08-4962-9077-b12ee72ffd5c"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"integral", " ", "=", " ", 
    RowBox[{"N", "[", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"X", "=", 
          RowBox[{"Interpolation", "[", " ", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Evaluate", "[", 
                  RowBox[{"expr0", "/.", "s"}], "]"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{
                  "\[Rho]", ",", " ", "start", ",", " ", "1", ",", " ", 
                   "0.001"}], "}"}]}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"Y", "=", 
          RowBox[{"Interpolation", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Evaluate", "[", 
                  RowBox[{"expr0", "/.", "s"}], "]"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{
                  "\[Rho]", ",", " ", "start", ",", " ", "1", ",", " ", 
                   "0.001"}], "}"}]}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ga", " ", "=", " ", 
          RowBox[{"Interpolation", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\[Rho]", "*", "radius"}], ")"}], "/", 
                  RowBox[{"(", "4.804489635145799`", ")"}]}], ")"}], "2"]}], 
              "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
              "\[Rho]", ",", " ", "start", ",", " ", "1", ",", " ", "0.001"}],
               "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
       " ", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Y", "[", "t", "]"}], "*", 
          RowBox[{"X", "[", "t", "]"}], "*", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"X", "[", "t", "]"}], ",", "t"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "1", ",", " ", "498.9923674182382"}], 
          "}"}]}], " ", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"mean3d", " ", "=", " ", 
    RowBox[{
     FractionBox["4", 
      SuperscriptBox["beamspot", "2"]], "*", "integral", 
     RowBox[{"(*", 
      RowBox[{
      "avg", " ", "thickness", " ", "with", " ", "given", " ", "beamspot"}], 
      "*)"}]}]}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQHfDv2/1bNm8cjz8NfwSiw848fQaiX0Wc+Aei16vt
ZroNpJVmThAG0fZ1Hi9/AOkpNTu+g2jF3Y9/g+hTVYGiP4G0SX+9PIiW/FSm
AKJjor/ogOhsCws9EP2obaEJiPZgLfEG0RM2LfEH0X+KeyJA9BzxgkwQneXL
nA2iA5ZyFIDoTVJq5SA6rzW3DmyP7r02EL1rS10PiF4hxT4PRDP8fb4IRMt9
j10BovPlD68B0ZcuXFgHoqd4b9gKooUa7x4C0Q5ehdy/gPQOu3IwnRjcJASi
K4Imi4DoJbNFi0B0m1l1GYhm25m3AkzPXbMBRK8L274VROv+2gemF/HxHQTR
H5neHgLRZpZ9yr+BtOZLeQ0Qna4lrAOin3nv0gXRAFi+z3Y=
  "],
 CellLabel->
  "In[201]:=",ExpressionUUID->"a32507c0-82a1-4645-b536-e9e84d4862c1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7855949465090923`*^9, 
  3.785594946516549*^9}},ExpressionUUID->"b29d7ed3-ee52-4a2d-bfe6-\
9fd89ca2aa77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "thickness", " ", "as", " ", "a", " ", "function", " ", "of", " ", "angle",
     " ", "from", " ", "normal"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"expr1", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ArcTan", "[", 
        RowBox[{"radius", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Rho]", "+", 
            RowBox[{
             SuperscriptBox["\[Epsilon]", 
              RowBox[{"2", "/", "3"}]], " ", 
             RowBox[{"r2", "[", "\[Rho]", "]"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"radius", "*", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Epsilon]", 
                RowBox[{"1", "/", "3", " "}]], 
               RowBox[{"z1", "[", "\[Rho]", "]"}]}], ")"}]}], "+", 
            "thickness"}], ")"}]}]}], "]"}], ",", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"radius", "*", 
            RowBox[{"(", 
             RowBox[{"\[Rho]", "+", 
              RowBox[{
               SuperscriptBox["\[Epsilon]", 
                RowBox[{"2", "/", "3"}]], " ", 
               RowBox[{"r2", "[", "\[Rho]", "]"}]}]}], ")"}]}], ")"}], "2"], 
         "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"radius", "*", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Epsilon]", 
                RowBox[{"1", "/", "3", " "}]], 
               RowBox[{"z1", "[", "\[Rho]", "]"}]}], ")"}]}], "+", 
            "thickness"}], ")"}], "2"]}]]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p1", " ", "=", " ", 
     RowBox[{"ParametricPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"expr1", "/.", "s"}], "]"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", " ", "start", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "10"}], " ", "}"}]}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p2", " ", "=", " ", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"thickness", "/", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", " ", "0", ",", " ", "1.5"}], "}"}], ",", " ", 
       RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{"p1", ",", " ", "p2"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<He_thickness_500Torr.txt\>\"", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"expr1", "/.", "s"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "\[Rho]", ",", " ", "start", ",", " ", "2.0", ",", " ", "0.001"}], 
        "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7806396867474117`*^9, 3.780639771428714*^9}, {
  3.780639816056715*^9, 3.7806399328536158`*^9}, {3.78064058745975*^9, 
  3.780640602993205*^9}, {3.7806413095117188`*^9, 3.780641327684979*^9}, {
  3.780641366050352*^9, 3.780641385146504*^9}, {3.780641445022813*^9, 
  3.7806414607373953`*^9}, {3.780641512297447*^9, 3.7806415670088997`*^9}, {
  3.780641639481546*^9, 3.780641691686164*^9}, {3.789970366153784*^9, 
  3.789970381447747*^9}, {3.789970596308319*^9, 3.7899706403635178`*^9}, {
  3.7899706944722977`*^9, 3.789970774912899*^9}, {3.789970869790217*^9, 
  3.7899708898896313`*^9}, {3.789972593113069*^9, 3.789972593316593*^9}, {
  3.7899727142418957`*^9, 3.789972730425212*^9}, {3.791186202415184*^9, 
  3.7911862036553993`*^9}, {3.791186926086418*^9, 3.791186936721569*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"93de9c2c-8193-4261-b004-6b670902a463"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "havar", " ", "entrance", " ", "angle", " ", "as", " ", "a", " ", 
    "function", " ", "of", " ", "angle", " ", "from", " ", "normal"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"expr2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ArcTan", "[", 
        RowBox[{"radius", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Rho]", "+", 
            RowBox[{
             SuperscriptBox["\[Epsilon]", 
              RowBox[{"2", "/", "3"}]], " ", 
             RowBox[{"r2", "[", "\[Rho]", "]"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"radius", "*", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Epsilon]", 
                RowBox[{"1", "/", "3", " "}]], 
               RowBox[{"z1", "[", "\[Rho]", "]"}]}], ")"}]}], "+", 
            "thickness"}], ")"}]}]}], "]"}], ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "-", 
        RowBox[{"ArcCos", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"radius", "*", 
              RowBox[{"(", 
               RowBox[{"\[Rho]", "+", 
                RowBox[{
                 SuperscriptBox["\[Epsilon]", 
                  RowBox[{"2", "/", "3"}]], " ", 
                 RowBox[{"r2", "[", "\[Rho]", "]"}]}]}], ")"}], "*", "radius",
               "*", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{
                 SuperscriptBox["\[Epsilon]", 
                  RowBox[{"2", "/", "3"}]], " ", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"r2", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], 
                  "]"}]}]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"radius", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Epsilon]", 
                    RowBox[{"1", "/", "3", " "}]], 
                   RowBox[{"z1", "[", "\[Rho]", "]"}]}], ")"}]}], "+", 
                "thickness"}], ")"}], "*", "radius", "*", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Epsilon]", 
                 RowBox[{"1", "/", "3", " "}]], 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"z1", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], 
                 "]"}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"radius", "*", 
                  RowBox[{"(", 
                   RowBox[{"\[Rho]", "+", 
                    RowBox[{
                    SuperscriptBox["\[Epsilon]", 
                    RowBox[{"2", "/", "3"}]], " ", 
                    RowBox[{"r2", "[", "\[Rho]", "]"}]}]}], ")"}]}], ")"}], 
                "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"radius", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Epsilon]", 
                    RowBox[{"1", "/", "3", " "}]], 
                    RowBox[{"z1", "[", "\[Rho]", "]"}]}], ")"}]}], "+", 
                  "thickness"}], ")"}], "2"]}]], "*", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"radius", "*", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{
                    SuperscriptBox["\[Epsilon]", 
                    RowBox[{"2", "/", "3"}]], " ", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"r2", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], 
                    "]"}]}]}], ")"}]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"radius", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["\[Epsilon]", 
                    RowBox[{"1", "/", "3", " "}]], 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"z1", "[", "\[Rho]", "]"}], ",", " ", "\[Rho]"}], 
                    "]"}]}], ")"}]}], ")"}], "2"]}]]}], ")"}]}], ")"}], 
         "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p3", " ", "=", " ", 
     RowBox[{"ParametricPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"expr2", "/.", "s"}], "]"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", " ", "start", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "1.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1.2"}], "}"}]}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p4", " ", "=", " ", 
     RowBox[{"Plot", "[", 
      RowBox[{"\[Theta]", ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", " ", "0", ",", " ", "1.5"}], "}"}], ",", " ", 
       RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{"p3", ",", " ", "p4"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<Entrance_angle_500Torr.txt\>\"", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"expr2", "/.", "s"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "\[Rho]", ",", " ", "start", ",", " ", "1.5", ",", " ", "0.001"}], 
        "}"}]}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.780639939323229*^9, 3.7806399509080343`*^9}, {
  3.7806399853157187`*^9, 3.780640207864439*^9}, {3.7806405694194183`*^9, 
  3.780640570523367*^9}, {3.78064060734444*^9, 3.780640607905321*^9}, {
  3.780640713014061*^9, 3.780640810699692*^9}, {3.780640848126244*^9, 
  3.780640858420368*^9}, {3.780641049398553*^9, 3.780641145234251*^9}, {
  3.780641398928406*^9, 3.780641438039905*^9}, {3.780641586680966*^9, 
  3.780641601366126*^9}, {3.7899709280840807`*^9, 3.789970975774055*^9}, {
  3.789972556656567*^9, 3.789972581755719*^9}, {3.791186978464328*^9, 
  3.79118701205443*^9}},
 CellLabel->
  "In[238]:=",ExpressionUUID->"3ab304f3-85c6-4cda-885f-d771ea7ce6ef"]
},
WindowSize->{1408, 987},
WindowMargins->{{0, Automatic}, {Automatic, 28}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5767, 178, 676, "Input",ExpressionUUID->"da58d656-8c53-41be-9b26-60e059231fb5"],
Cell[6328, 200, 9200, 228, 421, "Input",ExpressionUUID->"d87e94d5-04b1-41f3-8592-30c7170554c5"],
Cell[15531, 430, 3878, 92, 268, "Input",ExpressionUUID->"e57459e0-3751-46c7-9972-529c77c04cbf"],
Cell[19412, 524, 5008, 132, 239, "Input",ExpressionUUID->"922f1209-9b50-41be-bafb-7f36dc9f9131"],
Cell[24423, 658, 2758, 76, 217, "Input",ExpressionUUID->"edfbac34-8e08-4962-9077-b12ee72ffd5c"],
Cell[27184, 736, 3652, 90, 237, "Input",ExpressionUUID->"a32507c0-82a1-4645-b536-e9e84d4862c1"],
Cell[30839, 828, 154, 3, 31, "Input",ExpressionUUID->"b29d7ed3-ee52-4a2d-bfe6-9fd89ca2aa77"],
Cell[30996, 833, 4131, 104, 223, "Input",ExpressionUUID->"93de9c2c-8193-4261-b004-6b670902a463"],
Cell[35130, 939, 6676, 169, 269, "Input",ExpressionUUID->"3ab304f3-85c6-4cda-885f-d771ea7ce6ef"]
}
]
*)

